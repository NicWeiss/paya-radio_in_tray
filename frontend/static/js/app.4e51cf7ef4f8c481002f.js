webpackJsonp([1],{"/+f1":function(t,e){},NHnr:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("7+uW"),a=r("NYxO"),s=(r("m3Wc"),{render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]}),i=r("VU/8")({name:"App"},s,!1,null,null,null).exports,c=r("/ocq"),o=r("Xxa5"),u=r.n(o),l=r("exGp"),p=r.n(l),v=r("//Fk"),d=r.n(v),f=r("Gu7T"),h=r.n(f),m={setSession:function(t){localStorage.setItem("session",t)},getSession:function(){return localStorage.getItem("session")},isAuthenticated:function(){return!!localStorage.getItem("session")},invalidateSession:function(){localStorage.setItem("session","")}},g=r("VU/8")(m,null,!1,null,null,null).exports,k={get:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.doRequest.apply(this,["get"].concat(h()(e)))},put:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.doRequest.apply(this,["put"].concat(h()(e)))},post:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.doRequest.apply(this,["post"].concat(h()(e)))},delete:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.doRequest.apply(this,["delete"].concat(h()(e)))},doRequest:function(t,e){var r={method:t,url:"http://127.0.0.1:7778/"+e,headers:{"Content-Type":"application/json; charset=UTF-8"},data:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,json:!0};return g.isAuthenticated()&&(r.headers.session=g.getSession()),axios.defaults.headers.post["Access-Control-Allow-Origin"]="*",axios.defaults.headers.post["Access-Control-Allow-Headers"]="*",new d.a(function(t,e){axios(r).then(function(e){t(e.data)}).catch(function(t){"TOKEN EXPIRED"===t.data&&(console.log("asdas"),g.invalidateSession(),window.location.replace("/")),e(t)})}.bind(this))}},b=r("VU/8")(k,null,!1,null,null,null).exports,_={name:"Login",data:function(){return{login:"",password:""}},methods:{check:function(){var t=this;return p()(u.a.mark(function e(){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,e.prev=1,e.next=4,b.get("?get=client");case 4:r=e.sent,g.setSession(r.get.token),e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(1),console.log("error: ",e.t0),g.invalidateSession(),e.abrupt("return");case 13:console.log(r),t.$router.push("/");case 15:case"end":return e.stop()}},e,t,[[1,8]])}))()},logIn:function(){var t=this;return p()(u.a.mark(function e(){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,e.prev=1,e.next=4,b.get("?action=auth&user="+t.login+"&password="+t.password);case 4:r=e.sent,g.setSession(r.action.token),e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(1),console.log("error: ",e.t0),g.invalidateSession(),e.abrupt("return");case 13:console.log(r),t.$router.push("/");case 15:case"end":return e.stop()}},e,t,[[1,8]])}))()}},created:function(){this.check()}},y={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container"},[r("form",{staticClass:"login-form"},[r("div",{staticClass:"form-group mb-3"},[r("label",{attrs:{for:"exampleInputEmail1"}},[t._v("Email address")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.login,expression:"login"}],staticClass:"form-control",attrs:{type:"email",id:"exampleInputEmail1","aria-describedby":"emailHelp",placeholder:"Enter email"},domProps:{value:t.login},on:{input:function(e){e.target.composing||(t.login=e.target.value)}}}),t._v(" "),r("small",{staticClass:"form-text text-muted",attrs:{id:"emailHelp"}},[t._v("We'll never share your email with anyone else.")])]),t._v(" "),r("div",{staticClass:"form-group mb-4"},[r("label",{attrs:{for:"exampleInputPassword1"}},[t._v("Password")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",id:"exampleInputPassword1",placeholder:"Password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t._v(" "),r("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(e){return e.preventDefault(),t.logIn(e)}}},[t._v("\n      Submit\n    ")])])])},staticRenderFns:[]},x=r("VU/8")(_,y,!1,null,null,null).exports,w={name:"Player",components:{},methods:{check:function(){var t=this;return p()(u.a.mark(function e(){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,e.prev=1,e.next=4,b.get("?get=client");case 4:r=e.sent,g.setSession(r.get.token),e.next=14;break;case 8:return e.prev=8,e.t0=e.catch(1),console.log("error: ",e.t0),g.invalidateSession(),t.$router.push("/login"),e.abrupt("return");case 14:console.log(r);case 15:case"end":return e.stop()}},e,t,[[1,8]])}))()},dislike:function(){var t=this;return p()(u.a.mark(function e(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b.get("?action=dislike");case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return");case 8:case"end":return t.stop()}},e,t,[[0,5]])}))()},pause:function(){var t=this;return p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.get("?action=pause");case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return");case 8:"Paused"==t.state?t.state="Playing":t.state="Paused";case 9:case"end":return e.stop()}},e,t,[[0,5]])}))()},play:function(){var t=this;return p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.get("?action=play");case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return");case 8:t.get_track();case 9:case"end":return e.stop()}},e,t,[[0,5]])}))()},like:function(){var t=this;return p()(u.a.mark(function e(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b.get("?action=like");case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return");case 8:case"end":return t.stop()}},e,t,[[0,5]])}))()},next:function(){var t=this;return p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.get("?action=next");case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return");case 8:t.playPercent=0,t.get_track();case 10:case"end":return e.stop()}},e,t,[[0,5]])}))()},get_track:function(){var t=this;return p()(u.a.mark(function e(){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,e.prev=1,e.next=4,b.get("?get=track");case 4:r=e.sent,e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return");case 10:t.track=r.get.track,t.cover="data:image/png;base64, "+t.track.cover;case 12:case"end":return e.stop()}},e,t,[[1,7]])}))()},get_player:function(){var t=this;return p()(u.a.mark(function e(){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,e.prev=1,e.next=4,b.get("?get=player_state");case 4:r=e.sent,e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return");case 10:t.player=r.get.player_state,t.duration=t.player.track_duration,t.playInkrement=.5/(t.duration/100*.001),t.playPercent=Number((t.player.current_time*(100/t.player.track_duration)).toFixed(2)),t.state=t.player.state;case 15:case"end":return e.stop()}},e,t,[[1,7]])}))()},inkrement_progressbar:function(){"Playing"==this.state&&(this.playPercent=Number((Number(this.playPercent)+Number(this.playInkrement)).toFixed(2)),this.playPercent>100&&this.get_track())}},created:function(){var t=this;this.playPercent=0,this.state="",this.cover="",this.check(),this.get_track(),this.get_player();setInterval(function(){return t.get_player()},1e4),setInterval(function(){return t.inkrement_progressbar()},500)},data:function(){return{track:this.track,cover:this.cover,playPercent:this.playPercent}}},C={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"player"},[t._m(0),t._v(" "),t.track?r("div",[r("div",{staticClass:"player-body"},[r("div",{staticClass:"cover-section"},[r("img",{staticClass:"background-cover",attrs:{src:t.cover}}),t._v(" "),r("div",{staticClass:"cover-wrapper"},[r("img",{staticClass:"cover",attrs:{src:t.cover}})])]),t._v(" "),r("div",{staticClass:"control-section"},[r("div",{staticClass:"track-info"},[r("div",{staticClass:"title"},[t._v(t._s(t.track.title))]),t._v(" "),r("div",{staticClass:"artists"},[t._v(t._s(t.track.artists.join(", ")))])]),t._v(" "),r("div",{staticClass:"track-control"},[r("progress",{staticClass:"progress",attrs:{id:"file",max:"100"},domProps:{value:t.playPercent}}),t._v(" "),r("div",{staticClass:"controls"},[r("button",{staticClass:"btn btn-secondary"},[t._v("History")]),t._v(" "),r("div",[r("button",{staticClass:"btn btn-primary",on:{click:t.dislike}},[t._v("\n                Dislike\n              ")]),t._v(" "),r("button",{staticClass:"btn btn-primary",on:{click:t.pause}},[t._v("\n                Pause\n              ")]),t._v(" "),r("button",{staticClass:"btn btn-primary",on:{click:t.play}},[t._v("Play")]),t._v(" "),r("button",{staticClass:"btn btn-primary",on:{click:t.like}},[t._v("Like")])]),t._v(" "),r("button",{staticClass:"btn btn-primary",on:{click:t.next}},[t._v("Next")])])])])])]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"header"},[e("div",{staticClass:"station"},[this._v("On your wave")])])}]};var P=r("VU/8")(w,C,!1,function(t){r("/+f1")},null,null).exports,A={render:function(){var t=this.$createElement;return(this._self._c||t)("div",[this._v("404: Страница не найдена")])},staticRenderFns:[]};r("VU/8")({data:function(){return{}}},A,!1,null,null,null).exports;n.a.use(c.a);var S=new c.a({mode:"history",routes:[{path:"/login",name:"Login",component:x,meta:{onlyGuest:!0}},{path:"/",name:"Player",component:P,meta:{requiresAuth:!0}},{path:"*",redirect:"/login"}]});S.beforeEach(function(t,e,r){if(t.matched.some(function(t){return t.meta.onlyGuest})&&g.isAuthenticated())r("/");else{if(t.matched.some(function(t){return t.meta.requiresAuth})){if(g.isAuthenticated())return void r();r("/login")}r()}});var I=S;n.a.config.productionTip=!1,n.a.use(a.a);var E=new a.a.Store({state:{test:0},mutations:{setTest:function(t,e){t.test=e}},getters:{getTest:function(t){return t.test}}});new n.a({el:"#app",router:I,store:E,components:{App:i},template:"<App/>"})},m3Wc:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.4e51cf7ef4f8c481002f.js.map